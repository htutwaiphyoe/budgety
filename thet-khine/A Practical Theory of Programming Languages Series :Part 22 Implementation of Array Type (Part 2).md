# A Practical Theory of Programming Languages Series :Part 22 Implementation of Array Type (Part 2)

ဒီအပိုင်းက Array တွေကို programming language တွေမှာ ဘယ်လို implement လုပ်ထားသလဲပေါ့။ အားလုံးကို တခုချင်းလိုက်မပြောတော့ပဲနဲ. Major implementation တွေ လုပ်ပုံလုပ်နည်းကိုပဲပြောကြတာပေါ့။

Language implementation ဘက်ကနေစဉ်းစားရင် array ကို implement လုပ်မယ်ဆိုရင် array နဲ.ပတ်သတ်ပြီး ဘာတွေ ပေးထားလဲ အဲ့လိုပေးထားတဲ့ feature တွေရအောင် ဘယ်လိုပေးရမလဲဆိုတာကို စဉ်းစားရမှာပါ။ ဥပမာ VB, VB.NET မှာရှိတဲ့ array တွေသည် lower bound သုညကနေမဟုတ်ပဲနဲ. တခြား number ကနေ စလို.ရတယ်။ ဒါမျိုးကို compile time မှာတင် handle လုပ်လို.ရတယ် ။ ဥပမာ lower bound သည် 4 ကနေ စမယ်ဆိုပါစို. arr(4) ဆိုရင် lower bound ၄ ထဲက နှုတ်လိုက်ရင် 0 ရမယ်။ ဒီလိုမျိုး compile time မှာကတည်းက တွက်လိုက်ရင် အလုပ်မရှုပ်တော့ဘူး။ ဒါက ဥပမာ ပြောတာ VB, VB.NET မှညတကယ်လုပ်တယ်လို.မယူဆစေချင်ဘူး။ နောက်တခုက array တွေကို dynamically expand လုပ်ဖို.ပေးထားသလား။ ဥပမာ JavaScript မှာဆို array တွေသည် dynamically ချဲ.သွားလို.ရတယ်။ ဒါဆိုရင် ဒါမျိုးကို support လုပ်ပေးဖို. အတွက် runtime မှာ array သည် နဂိုမူလက item 3 ခုရှိတယ်ဆိုပါစို. ။ နောက်ထပ် ထပ်ချဲ့တာသည် 5 ဖြစ်မယ်ဆိုရင် 5 ခန်းကိုဆန်.အောင် memory မှာ 5 ခန်းဆန်.တဲ့နေရာတခု အသစ်ပြန်ယူ ခုနက ရှိပြီးသား အရင် array ကို copy ကူး အဲ့လိုလုပ်ရမယ်။ ဒါသည် dynamically expand လုပ်တဲ့ array တွေဖို. runtime ကလိုက်လုပ်ပေးရတာ။

နောက်တချက်က multidimensional array နဲ.ပေးသိမ်းမလား array of array နဲ.ပေးသိမ်းမလား။ Multidimensional array ဆိုတာ သဘောအားဖြင့် မြင်သာအောင် ပြရရင် excel လို row နဲ. column တနေရာ တည်း တဆက်တည်းသိမ်းတာမျိုးကိုဆိုလိုတယ်။ ဥပမာ int [2][3] သူ.ကို multidimensional array အနေနဲ.သိမ်းမယ်ဆိုရင် 2*3 = 6  နောက် integer size 4 byte နဲ.မြှောက်ပြီးတော့ 24 bytes ရှိတဲ့ memory area ဆက်တိုက်ကြီးကိုလိုတယ်။ ဆိုချင်တာက multidimensional array သည် memory မှာ ဆက်တိုက် continuous နေရာယူတယ်ပြောတာ။ နောက် Array of array ဆိုတာက ကျတော့ ခုနက in [2][3] ဆိုပါစို. သူ.ကိုယူမယ်ဆိုရင်။ ပထမ outer က row သည် ၂ ခု element 2 ခုရှိတဲ့ array ကို Object တခုအနေနဲ.သိမ်းမယ်။ နောက် ထပ်ကမှ ပထမ array ရဲ. [0] အခန်း နဲ. [1] အခန်းမှာ တခြား array object ၂ ခုသိမ်းမယ်။ အဲ့တာဆို စုစုပေါင်း array object ၃ ခုလိုမယ်။ ဒီလိုသိမ်းရင် memory မှာ ဆက်တိုက်နေရာလွတ်ရှိဖို.မလိုဘူး ပထမဆုံး elements 2 ခုရှိတဲ့ array ဖို. နေရာလွတ်ရယ်။ နောက် elements 3 ခုရှိတဲ့ array ၂ ခုဖို. နေရာလွတ်ရယ် ရှိရင်ရပြီ။ တဆက်တည်းဖြစ်ဖို.မလိုဘူး။ Java မှာ array of array ပဲရတယ်။ Multidimensional array မရဘူး။ C# မှာ  array of array ရော multidimensional array ရောရတယ်။

Multidimensional array နဲ. array of array သည် design ပိုင်းအရ ဘာတွေကွာသွားသလဲ ဆိုလို.၇ှိရင် multidimensional array သုံးမယ်ဆိုရင် large array တွေဆိုရင် memory area ကြီးကြီး တဆက်တည်းရှိမှ အဆင်ပြေမယ်။ array of array ကျတော့  fragmented ဖြစ်နေတာလေးတွေရှိလဲရတယ်။ ဒါက space ဘက်ကကြည့်တာ။ နောက်တချက် index ထောက်ထဲ့ဘက်ကကြည့်ရင် multidimensional array ရဲ. အခန်း ဥပမာ arr[1][2] ဆိုရင် lower index, upper index သိတာနဲ. formula သုံးပြီး ဒီအခန်းရဲ. memory address ကိုတွက်ထုတ်လို.၇တယ်။ အဲ့တော့ accesss သည် မြန်တယ်။ Array of array မှာကျတော့ အဲ့လိုမဟုတ်ဘူး ပထမဆုံး arr[1][2] ကို evaluate လုပ်မယ်ဆိုရင် arr ရဲ. 1 အခန်းကိုထောက် အဲ့ကောင်ထဲကမှ array ရဲ. 2 ကိုပြန်ထောက် အဲ့လို နှစ်ဆင့်သွားနေရမယ်။ ဒီတော့ level of indirection အရကြည့်ရင် နှေးတယ်။ Memory management , garbage collection အရကြည့်ရင် multidimensional array သည် တဆက်တည်း data တခုအနေနဲ.သိမ်းလို. သူ.ကို garbage collect လုပ်ရင် မြန်မယ်။ array of array ကျတော့ array လေးတွေ အများကြီး လိုက်သိမ်းနေရလို. ပိုအလုပ်ရှုပ်မယ်။ အမှိုက်ထုတ်ကြီး စုထားတာနဲ. အမှိုက်ကလေးတွေ တခုချင်းပြန်.ကျဲနေရတာကို သိမ်းရသလိုပေါ့။

ခုနက Multidimensional array တွေကိုသိမ်းတဲ့နေရာမှာ row major order, column major order ဆိုပြီး ၂မျိုးခွဲလို.၇တယ်။ ဆိုချင်တာက row by row တဆက်တည်းသိမ်းမလား။ column ကို အဓိက major ထားပြီးသိမ်းမလားပေါ့။ အဲ့အတွက်ဆိုင်ရာ index တွက်တဲ့ formula တွေရှိတယ် စိတ်ဝင်စားရင်ရှာကြည့်ပေါ့။နောက် memory မှာ runtime မှာ array ကိုသိမ်းမယ်ဆိုရင် ဒါတွေလိုတယ်။

TypeDescriptor (Array type မှန်းသိအောင်)
Element Type(Array ရဲ. child element တွေက ဘာလဲဆိုတာသိအောင်)
Index Type(တချို. language တွေ Python , Php, Ruby, associative array ဆိုတာရှိတယ်။  key value, ဒါမှမဟုတ် array index ကို string , object တွေအနေနဲ.ထားလို.ရတာမျိုးအဲ့တာမျိုးသိမ်းဖို.လိုတယ်။)

Index lower bound( ဒါက array lower bound ဘယ္ကစတယ္ဆုိတာမွတ္တာ)
Index upper bound( သူက်ေတာ့ဘယ္မွာဆံုးတယ္ဆုိတာသိရေအာင္မွတ္တယ္)
Address ( array ရဲ. တကယ့် physical location address in memory ကိုမှတ်တာ)
Modern language တွေမယ် array ကို runtime မှာ check လုပ်ကြတယ် lower bound, upper bound ကျော်သလားဆိုတာ ကျော်ရင် exception ပေးတယ်။ အဲ့တာတွေကို runtime မှာလုပ်ကြတယ်။ C/C++ လိုကောင်မျိုးကျတော့ မလုပ်ကြဘူး ဒါကြောင့် သူတို.ကို memory unsafe language လို.လဲဆိုကြတယ်။
